(function(){"use strict";var e={4767:function(e,t,a){var o=a(5130),n=(a(4114),a(6768)),l=a(144),r=a(4232),u=a(1527),c=a.n(u),i=a(819);const s={class:"quark"},d={class:"quark-icon"},v={class:"quark-body"},p={class:"quark-content"},f={key:0},m=["src"],k={key:0,class:"quark-transcript"},g=["hidden"];function h(e){this.trans_content=e}const b={name:"QuarkViewer"};var y=Object.assign(b,{props:{quarkID:String},setup(e){const t={loading:{icon:"refresh",color:"#808080"},text:{icon:"translate",color:"var(--color-primary)"},image:{icon:"image",color:"var(--color-success)"},"transcript/info":{icon:"information",color:"#808080"},"transcript/explain":{icon:"message-text-outline",color:"#808080"}},a=e;var o=(0,l.KR)("");const u=(0,l.KR)({id:"Q-1",type:"text",content:"Loading ...",transcripts:[]}),c=(0,l.KR)(t.loading);function b(){var e="http://localhost:8000/quark/"+a.quarkID;fetch(e).then((e=>e.json())).then((e=>{u.value=e.quark,c.value=t[e.quark.type]}))}return b(),(e,a)=>{const b=(0,n.g2)("var-icon"),y=(0,n.g2)("var-avatar"),_=(0,n.g2)("var-divider"),F=(0,n.g2)("var-avatar-group");return(0,n.uX)(),(0,n.CE)("div",s,[(0,n.Lk)("div",d,[(0,n.bF)(y,{round:!1,size:"small",color:c.value.color},{default:(0,n.k6)((()=>[(0,n.bF)(b,{name:c.value.icon},null,8,["name"])])),_:1},8,["color"])]),(0,n.Lk)("div",v,[(0,n.Lk)("div",p,["text"==u.value.type?((0,n.uX)(),(0,n.CE)("div",f,[(0,n.bF)((0,l.R1)(i.f),{content:u.value.content},null,8,["content"])])):(0,n.Q3)("",!0),"image"==u.value.type?((0,n.uX)(),(0,n.CE)("img",{key:1,src:"http://localhost:8000"+u.value.content},null,8,m)):(0,n.Q3)("",!0)]),0!=u.value.transcripts.length?((0,n.uX)(),(0,n.CE)("div",k,[(0,n.bF)(_,{dashed:""}),(0,n.bF)(F,null,{default:(0,n.k6)((()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(u.value.transcripts,(e=>((0,n.uX)(),(0,n.Wv)(y,{key:e.id,onClick:t=>h(e.content),hoverable:"",bordered:"",size:"small",color:t[e.type].color},{default:(0,n.k6)((()=>[(0,n.bF)(b,{name:t[e.type].icon},null,8,["name"])])),_:2},1032,["onClick","color"])))),128)),""!=(0,l.R1)(o)?((0,n.uX)(),(0,n.Wv)(y,{key:0,onClick:a[0]||(a[0]=e=>h("")),hoverable:"",size:"small",color:"var(--color-error)"},{default:(0,n.k6)((()=>[(0,n.bF)(b,{name:"window-close",color:"var(--color-danger)"})])),_:1})):(0,n.Q3)("",!0)])),_:1}),(0,n.Lk)("p",{class:"trans-show markdown",hidden:!(0,l.R1)(o)},(0,r.v_)((0,l.R1)(o)),9,g)])):(0,n.Q3)("",!0)])])}}}),_=a(1241);const F=(0,_.A)(y,[["__scopeId","data-v-01788890"]]);var w=F,C=a(3080),q=a(8484);const L={key:0,class:"mask"},O={class:"qtype-choose noselect"},x={class:"content-editor"},A={key:0},j={key:1},E={class:"footer-controller"},R={name:"QuarkEditDialog",props:{activate:Boolean,add_quark:Function,closeDialog:Function}};var D=Object.assign(R,{setup(e){const t=(0,l.KR)("text"),a=(0,l.KR)([{label:"Text",value:"text"},{label:"Media",value:"media"}]),o=(0,l.KR)(""),r=(0,l.KR)([]);function u(e){function t(){o.value="",r.value=[],e()}0!=o.value.length||0!=r.value.length?(0,C.Ay)({title:"退出编辑",message:"您有更改尚未保存，推出编辑将丢失更改。确定要退出吗？",confirmButtonText:"退出",cancelButtonText:"继续编辑",onConfirm:t}):t()}function c(e){}async function s(e,t){const a="http://localhost:8000/quark",o=new FormData;o.append("type",e),o.append("content",t);var n=await fetch(a,{method:"POST",body:o});return n.json()}function d(e,t){q.Ay[e](t)}async function v(e,a){var n=[];if("text"===t.value){let a=await s(t.value,o.value);0!=a.code&&d("error","Upload Failed (createQuark."+a.code+")."),n.push(a.quark_id),d("success","Upload Success."),e()}else if("media"===t.value){for(var l=0;l<r.value.length;l++){var u=r.value[l],c=u.file.type.split("/")[0];if("image"!=c&&"video"!=c)return void d("error","Invalid File Type.");let e=await s(c,u.file);if(0!=e.code)return void d("error","Upload Failed (createQuark."+e.code+").");n.push(e.quark_id),u.status="success"}d("success","Upload Success."),e()}a(n)}return(s,d)=>{const p=(0,n.g2)("var-icon"),f=(0,n.g2)("var-button"),m=(0,n.g2)("var-radio-group"),k=(0,n.g2)("var-uploader"),g=(0,n.g2)("var-paper");return e.activate?((0,n.uX)(),(0,n.CE)("div",L,[(0,n.bF)(g,{class:"content"},{default:(0,n.k6)((()=>[(0,n.bF)(f,{type:"danger",round:"","icon-container":"",class:"close-button",onClick:d[0]||(d[0]=t=>u(e.closeDialog))},{default:(0,n.k6)((()=>[(0,n.bF)(p,{name:"window-close"})])),_:1}),d[6]||(d[6]=(0,n.Lk)("h2",{class:"noselect"},"New Quark",-1)),(0,n.Lk)("div",O,[(0,n.bF)(m,{modelValue:t.value,"onUpdate:modelValue":d[1]||(d[1]=e=>t.value=e),options:a.value},null,8,["modelValue","options"])]),(0,n.Lk)("div",x,["text"===t.value?((0,n.uX)(),(0,n.CE)("div",A,[(0,n.bF)((0,l.R1)(i.t),{modelValue:o.value,"onUpdate:modelValue":d[2]||(d[2]=e=>o.value=e)},null,8,["modelValue"])])):(0,n.Q3)("",!0),"media"===t.value?((0,n.uX)(),(0,n.CE)("div",j,[(0,n.bF)(k,{modelValue:r.value,"onUpdate:modelValue":d[3]||(d[3]=e=>r.value=e),multiple:!0,accept:"image/*,video/*",onAfterRead:c},null,8,["modelValue"])])):(0,n.Q3)("",!0)]),(0,n.Lk)("div",E,[(0,n.bF)(f,{type:"success",class:"btn-upload",onClick:d[4]||(d[4]=t=>v(e.closeDialog,e.add_quark))},{default:(0,n.k6)((()=>d[5]||(d[5]=[(0,n.eW)("Save")]))),_:1})])])),_:1})])):(0,n.Q3)("",!0)}}});const X=(0,_.A)(D,[["__scopeId","data-v-347f3b2c"]]);var I=X;const K={key:0,class:"atom"},Q={class:"atom-head"},S={class:"atom-info"},U={class:"atom-info"},T={class:"atom-contents"},V={class:"quarks-container"},M={class:"drag-handle"},W={name:"AtomViewer"};var P=Object.assign(W,{props:{atomID:String,tempAtom:Boolean,atomUpd:Function},setup(e){const t=e,a=(0,l.KR)(!1);function o(e){var t=new Date(e),a=new Date,o=a-t;if(o<36e5)return Math.floor(o/6e4)+" minutes ago";if(o<864e5)return Math.floor(o/36e5)+" hours ago";if(o<6048e5){var n=["星期天","星期一","星期二","星期三","星期四","星期五","星期六"];return n[t.getDay()]}return t.toLocaleString()}const u=(0,l.KR)("content-copy");function i(e){u.value="check",navigator.clipboard.writeText(e),setTimeout((()=>{u.value="content-copy"}),1e3)}function s(){if(t.tempAtom)d.value={title:"New Atom",tags:[],id:"A-new",last_modify:"Just Now",contents:[]};else{var e="http://localhost:8000/atom/"+t.atomID;fetch(e).then((e=>e.json())).then((e=>{d.value=e.atom}))}}const d=(0,l.KR)({title:"Loading ..."});function v(){m()}function p(){a.value=!0}function f(e){for(var t=0;t<e.length;t++)d.value.contents.push(e[t]);m()}function m(){var e="http://localhost:8000/atom/"+d.value.id+"/editquarks";fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({quarks:d.value.contents})}).then((e=>e.json())).then((e=>{0==e.code?t.atomUpd&&t.atomUpd(e.atom_id):(q.Ay.error("Update Failed (atom.editquark."+e.code+")."),console.log("Error: "+e.message))}))}return s(),(e,t)=>{const s=(0,n.g2)("var-badge"),m=(0,n.g2)("var-space"),k=(0,n.g2)("var-icon"),g=(0,n.g2)("var-paper"),h=(0,n.g2)("var-button");return(0,n.uX)(),(0,n.CE)(n.FK,null,[d.value?((0,n.uX)(),(0,n.CE)("div",K,[(0,n.Lk)("div",Q,[(0,n.Lk)("h1",null,(0,r.v_)(d.value.title),1),(0,n.bF)(m,null,{default:(0,n.k6)((()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(d.value.tags,(e=>((0,n.uX)(),(0,n.Wv)(s,{key:e,value:e,type:"primary"},null,8,["value"])))),128))])),_:1}),t[1]||(t[1]=(0,n.Lk)("br",null,null,-1)),(0,n.Lk)("li",S,[(0,n.eW)("ID: "+(0,r.v_)(d.value.id)+" ",1),(0,n.bF)(k,{name:u.value,onClick:t[0]||(t[0]=e=>i(d.value.id))},null,8,["name"])]),(0,n.Lk)("li",U,"Last Modified: "+(0,r.v_)(o(d.value.last_modify)),1)]),(0,n.Lk)("div",T,[t[3]||(t[3]=(0,n.Lk)("h3",null,"Contents",-1)),(0,n.Lk)("div",V,[(0,n.bF)((0,l.R1)(c()),{list:d.value.contents,animation:"200","item-key":e=>e,"ghost-class":"ghost",handle:".drag-handle,.quark-icon",onEnd:v},{item:(0,n.k6)((({element:e})=>[(0,n.bF)(g,{class:"quark-container",elevation:1},{default:(0,n.k6)((()=>[(0,n.Lk)("div",M,[(0,n.bF)(k,{name:"menu",color:"grey"})]),(0,n.bF)(w,{quarkID:e},null,8,["quarkID"])])),_:2},1024)])),footer:(0,n.k6)((()=>[(0,n.bF)(h,{onClick:p,type:"primary"},{default:(0,n.k6)((()=>t[2]||(t[2]=[(0,n.eW)("+ Quark")]))),_:1})])),_:1},8,["list","item-key"])])])])):(0,n.Q3)("",!0),(0,n.Lk)("div",null,[(0,n.bF)(I,{activate:a.value,add_quark:f,"close-dialog":()=>a.value=!1},null,8,["activate","close-dialog"])])],64)}}});const B=(0,_.A)(P,[["__scopeId","data-v-2b341672"]]);var N=B;const z={class:"atom-container"},$={class:"controllers"},J={name:"App",components:{AtomViewer:N}};var G=Object.assign(J,{setup(e){const t=(0,l.KR)(["?-loading"]);function a(){var e="http://localhost:8000/atom_list";fetch(e).then((e=>e.json())).then((e=>{t.value=e.atom_list}))}function o(){var e=`?-${Math.random()}-${performance.now()}`;t.value.push(e)}function r(e){function a(a){if(console.log("Atom Updated: "+a),"?"==e[0]){var o=t.value.indexOf(e);t.value[o]=a}}return a}return a(),(e,a)=>{const l=(0,n.g2)("var-paper"),u=(0,n.g2)("var-space"),c=(0,n.g2)("var-button");return(0,n.uX)(),(0,n.CE)("div",z,[(0,n.bF)(u,{direction:"column",wrap:"wrap"},{default:(0,n.k6)((()=>[((0,n.uX)(!0),(0,n.CE)(n.FK,null,(0,n.pI)(t.value,(e=>((0,n.uX)(),(0,n.Wv)(l,{elevation:2,key:e},{default:(0,n.k6)((()=>[(0,n.bF)(N,{atomID:e,tempAtom:"?"==e[0],atomUpd:r(e)},null,8,["atomID","tempAtom","atomUpd"])])),_:2},1024)))),128))])),_:1}),(0,n.Lk)("div",$,[(0,n.bF)(c,{type:"primary",onClick:a[0]||(a[0]=e=>o())},{default:(0,n.k6)((()=>a[1]||(a[1]=[(0,n.eW)("+ Atom")]))),_:1})])])}}});const H=G;var Y=H,Z=a(286),ee=(a(1710),(0,o.Ef)(Y));ee.use(Z.Ay$),ee.mount("#app")}},t={};function a(o){var n=t[o];if(void 0!==n)return n.exports;var l=t[o]={exports:{}};return e[o].call(l.exports,l,l.exports,a),l.exports}a.m=e,function(){var e=[];a.O=function(t,o,n,l){if(!o){var r=1/0;for(s=0;s<e.length;s++){o=e[s][0],n=e[s][1],l=e[s][2];for(var u=!0,c=0;c<o.length;c++)(!1&l||r>=l)&&Object.keys(a.O).every((function(e){return a.O[e](o[c])}))?o.splice(c--,1):(u=!1,l<r&&(r=l));if(u){e.splice(s--,1);var i=n();void 0!==i&&(t=i)}}return t}l=l||0;for(var s=e.length;s>0&&e[s-1][2]>l;s--)e[s]=e[s-1];e[s]=[o,n,l]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var o in t)a.o(t,o)&&!a.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};a.O.j=function(t){return 0===e[t]};var t=function(t,o){var n,l,r=o[0],u=o[1],c=o[2],i=0;if(r.some((function(t){return 0!==e[t]}))){for(n in u)a.o(u,n)&&(a.m[n]=u[n]);if(c)var s=c(a)}for(t&&t(o);i<r.length;i++)l=r[i],a.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return a.O(s)},o=self["webpackChunkcapsule_frontend"]=self["webpackChunkcapsule_frontend"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=a.O(void 0,[504],(function(){return a(4767)}));o=a.O(o)})();
//# sourceMappingURL=app.050893b4.js.map
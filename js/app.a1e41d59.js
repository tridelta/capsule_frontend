(function(){"use strict";var e={4960:function(e,t,a){var n=a(5130),o=(a(4114),a(6768)),r=a(144);const l="http://capsule-api.berniehg.top";var u=l,i=a(4232),c=a(1527),s=a.n(c),d=a(819);const v={class:"quark"},p={class:"quark-icon"},f={class:"quark-body"},m={class:"quark-content"},k={key:0},g=["src"],h={key:0,class:"quark-transcript"},b=["hidden"];function y(e){this.trans_content=e}const _={name:"QuarkViewer"};var F=Object.assign(_,{props:{quarkID:String},setup(e){const t={loading:{icon:"refresh",color:"#808080"},text:{icon:"translate",color:"var(--color-primary)"},image:{icon:"image",color:"var(--color-success)"},"transcript/info":{icon:"information",color:"#808080"},"transcript/explain":{icon:"message-text-outline",color:"#808080"}},a=e;var n=(0,r.KR)("");const l=(0,r.KR)({id:"Q-1",type:"text",content:"Loading ...",transcripts:[]}),c=(0,r.KR)(t.loading);function s(){const e=`${u}/quark/${a.quarkID}`;fetch(e).then((e=>e.json())).then((e=>{l.value=e.quark,c.value=t[e.quark.type]}))}return s(),(e,a)=>{const s=(0,o.g2)("var-icon"),_=(0,o.g2)("var-avatar"),F=(0,o.g2)("var-divider"),w=(0,o.g2)("var-avatar-group");return(0,o.uX)(),(0,o.CE)("div",v,[(0,o.Lk)("div",p,[(0,o.bF)(_,{round:!1,size:"small",color:c.value.color},{default:(0,o.k6)((()=>[(0,o.bF)(s,{name:c.value.icon},null,8,["name"])])),_:1},8,["color"])]),(0,o.Lk)("div",f,[(0,o.Lk)("div",m,["text"==l.value.type?((0,o.uX)(),(0,o.CE)("div",k,[(0,o.bF)((0,r.R1)(d.f),{content:l.value.content},null,8,["content"])])):(0,o.Q3)("",!0),"image"==l.value.type?((0,o.uX)(),(0,o.CE)("img",{key:1,src:`${(0,r.R1)(u)}${l.value.content}`},null,8,g)):(0,o.Q3)("",!0)]),0!=l.value.transcripts.length?((0,o.uX)(),(0,o.CE)("div",h,[(0,o.bF)(F,{dashed:""}),(0,o.bF)(w,null,{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(l.value.transcripts,(e=>((0,o.uX)(),(0,o.Wv)(_,{key:e.id,onClick:t=>y(e.content),hoverable:"",bordered:"",size:"small",color:t[e.type].color},{default:(0,o.k6)((()=>[(0,o.bF)(s,{name:t[e.type].icon},null,8,["name"])])),_:2},1032,["onClick","color"])))),128)),""!=(0,r.R1)(n)?((0,o.uX)(),(0,o.Wv)(_,{key:0,onClick:a[0]||(a[0]=e=>y("")),hoverable:"",size:"small",color:"var(--color-error)"},{default:(0,o.k6)((()=>[(0,o.bF)(s,{name:"window-close",color:"var(--color-danger)"})])),_:1})):(0,o.Q3)("",!0)])),_:1}),(0,o.Lk)("p",{class:"trans-show markdown",hidden:!(0,r.R1)(n)},(0,i.v_)((0,r.R1)(n)),9,b)])):(0,o.Q3)("",!0)])])}}}),w=a(1241);const C=(0,w.A)(F,[["__scopeId","data-v-1fd42dcc"]]);var q=C,L=a(3080),O=a(8484);const x={key:0,class:"mask"},A={class:"qtype-choose noselect"},R={class:"content-editor"},j={key:0},E={key:1},D={class:"footer-controller"},X={name:"QuarkEditDialog",props:{activate:Boolean,add_quark:Function,closeDialog:Function}};var I=Object.assign(X,{setup(e){const t=(0,r.KR)("text"),a=(0,r.KR)([{label:"Text",value:"text"},{label:"Media",value:"media"}]),n=(0,r.KR)(""),l=(0,r.KR)([]);function i(e){function t(){n.value="",l.value=[],e()}0!=n.value.length||0!=l.value.length?(0,L.Ay)({title:"退出编辑",message:"您有更改尚未保存，推出编辑将丢失更改。确定要退出吗？",confirmButtonText:"退出",cancelButtonText:"继续编辑",onConfirm:t}):t()}function c(e){}async function s(e,t){const a=`${u}/quark`,n=new FormData;n.append("type",e),n.append("content",t);var o=await fetch(a,{method:"POST",body:n});return o.json()}function v(e,t){O.Ay[e](t)}async function p(e,a){var o=[];if("text"===t.value){let a=await s(t.value,n.value);0!=a.code&&v("error","Upload Failed (createQuark."+a.code+")."),o.push(a.quark_id),v("success","Upload Success."),e()}else if("media"===t.value){for(var r=0;r<l.value.length;r++){var u=l.value[r],i=u.file.type.split("/")[0];if("image"!=i&&"video"!=i)return void v("error","Invalid File Type.");let e=await s(i,u.file);if(0!=e.code)return void v("error","Upload Failed (createQuark."+e.code+").");o.push(e.quark_id),u.status="success"}v("success","Upload Success."),e()}a(o)}return(u,s)=>{const v=(0,o.g2)("var-icon"),f=(0,o.g2)("var-button"),m=(0,o.g2)("var-radio-group"),k=(0,o.g2)("var-uploader"),g=(0,o.g2)("var-paper");return e.activate?((0,o.uX)(),(0,o.CE)("div",x,[(0,o.bF)(g,{class:"content"},{default:(0,o.k6)((()=>[(0,o.bF)(f,{type:"danger",round:"","icon-container":"",class:"close-button",onClick:s[0]||(s[0]=t=>i(e.closeDialog))},{default:(0,o.k6)((()=>[(0,o.bF)(v,{name:"window-close"})])),_:1}),s[6]||(s[6]=(0,o.Lk)("h2",{class:"noselect"},"New Quark",-1)),(0,o.Lk)("div",A,[(0,o.bF)(m,{modelValue:t.value,"onUpdate:modelValue":s[1]||(s[1]=e=>t.value=e),options:a.value},null,8,["modelValue","options"])]),(0,o.Lk)("div",R,["text"===t.value?((0,o.uX)(),(0,o.CE)("div",j,[(0,o.bF)((0,r.R1)(d.t),{modelValue:n.value,"onUpdate:modelValue":s[2]||(s[2]=e=>n.value=e)},null,8,["modelValue"])])):(0,o.Q3)("",!0),"media"===t.value?((0,o.uX)(),(0,o.CE)("div",E,[(0,o.bF)(k,{modelValue:l.value,"onUpdate:modelValue":s[3]||(s[3]=e=>l.value=e),multiple:!0,accept:"image/*,video/*",onAfterRead:c},null,8,["modelValue"])])):(0,o.Q3)("",!0)]),(0,o.Lk)("div",D,[(0,o.bF)(f,{type:"success",class:"btn-upload",onClick:s[4]||(s[4]=t=>p(e.closeDialog,e.add_quark))},{default:(0,o.k6)((()=>s[5]||(s[5]=[(0,o.eW)("Save")]))),_:1})])])),_:1})])):(0,o.Q3)("",!0)}}});const K=(0,w.A)(I,[["__scopeId","data-v-774a8d3e"]]);var Q=K;const S={key:0,class:"atom"},U={class:"atom-head"},T={class:"atom-info"},$={class:"atom-info"},V={class:"atom-contents"},M={class:"quarks-container"},W={class:"drag-handle"},P={name:"AtomViewer"};var B=Object.assign(P,{props:{atomID:String,tempAtom:Boolean,atomUpd:Function},setup(e){const t=e,a=(0,r.KR)(!1);function n(e){var t=new Date(e),a=new Date,n=a-t;if(n<36e5)return Math.floor(n/6e4)+" minutes ago";if(n<864e5)return Math.floor(n/36e5)+" hours ago";if(n<6048e5){var o=["星期天","星期一","星期二","星期三","星期四","星期五","星期六"];return o[t.getDay()]}return t.toLocaleString()}const l=(0,r.KR)("content-copy");function c(e){l.value="check",navigator.clipboard.writeText(e),setTimeout((()=>{l.value="content-copy"}),1e3)}function d(){if(t.tempAtom)v.value={title:"New Atom",tags:[],id:"A-new",last_modify:"Just Now",contents:[]};else{var e=`${u}/atom/${t.atomID}`;fetch(e).then((e=>e.json())).then((e=>{v.value=e.atom}))}}const v=(0,r.KR)({title:"Loading ..."});function p(){k()}function f(){a.value=!0}function m(e){for(var t=0;t<e.length;t++)v.value.contents.push(e[t]);k()}function k(){var e=`${u}/atom/${v.value.id}/editquarks`;fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({quarks:v.value.contents})}).then((e=>e.json())).then((e=>{0==e.code?t.atomUpd&&t.atomUpd(e.atom_id):(O.Ay.error("Update Failed (atom.editquark."+e.code+")."),console.log("Error: "+e.message))}))}return d(),(e,t)=>{const u=(0,o.g2)("var-badge"),d=(0,o.g2)("var-space"),k=(0,o.g2)("var-icon"),g=(0,o.g2)("var-paper"),h=(0,o.g2)("var-button");return(0,o.uX)(),(0,o.CE)(o.FK,null,[v.value?((0,o.uX)(),(0,o.CE)("div",S,[(0,o.Lk)("div",U,[(0,o.Lk)("h1",null,(0,i.v_)(v.value.title),1),(0,o.bF)(d,null,{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(v.value.tags,(e=>((0,o.uX)(),(0,o.Wv)(u,{key:e,value:e,type:"primary"},null,8,["value"])))),128))])),_:1}),t[1]||(t[1]=(0,o.Lk)("br",null,null,-1)),(0,o.Lk)("li",T,[(0,o.eW)("ID: "+(0,i.v_)(v.value.id)+" ",1),(0,o.bF)(k,{name:l.value,onClick:t[0]||(t[0]=e=>c(v.value.id))},null,8,["name"])]),(0,o.Lk)("li",$,"Last Modified: "+(0,i.v_)(n(v.value.last_modify)),1)]),(0,o.Lk)("div",V,[t[3]||(t[3]=(0,o.Lk)("h3",null,"Contents",-1)),(0,o.Lk)("div",M,[(0,o.bF)((0,r.R1)(s()),{list:v.value.contents,animation:"200","item-key":e=>e,"ghost-class":"ghost",handle:".drag-handle,.quark-icon",onEnd:p},{item:(0,o.k6)((({element:e})=>[(0,o.bF)(g,{class:"quark-container",elevation:1},{default:(0,o.k6)((()=>[(0,o.Lk)("div",W,[(0,o.bF)(k,{name:"menu",color:"grey"})]),(0,o.bF)(q,{quarkID:e},null,8,["quarkID"])])),_:2},1024)])),footer:(0,o.k6)((()=>[(0,o.bF)(h,{onClick:f,type:"primary"},{default:(0,o.k6)((()=>t[2]||(t[2]=[(0,o.eW)("+ Quark")]))),_:1})])),_:1},8,["list","item-key"])])])])):(0,o.Q3)("",!0),(0,o.Lk)("div",null,[(0,o.bF)(Q,{activate:a.value,add_quark:m,"close-dialog":()=>a.value=!1},null,8,["activate","close-dialog"])])],64)}}});const N=(0,w.A)(B,[["__scopeId","data-v-54828ae6"]]);var z=N;const J={class:"atom-container"},G={class:"controllers"},H={name:"App",components:{AtomViewer:z}};var Y=Object.assign(H,{setup(e){const t=(0,r.KR)(["?-loading"]);function a(){const e=`${u}/atom_list`;fetch(e).then((e=>e.json())).then((e=>{t.value=e.atom_list}))}function n(){var e=`?-${Math.random()}-${performance.now()}`;t.value.push(e)}function l(e){function a(a){if(console.log("Atom Updated: "+a),"?"==e[0]){var n=t.value.indexOf(e);t.value[n]=a}}return a}return a(),(e,a)=>{const r=(0,o.g2)("var-paper"),u=(0,o.g2)("var-space"),i=(0,o.g2)("var-button");return(0,o.uX)(),(0,o.CE)("div",J,[(0,o.bF)(u,{direction:"column",wrap:"wrap"},{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(t.value,(e=>((0,o.uX)(),(0,o.Wv)(r,{elevation:2,key:e},{default:(0,o.k6)((()=>[(0,o.bF)(z,{atomID:e,tempAtom:"?"==e[0],atomUpd:l(e)},null,8,["atomID","tempAtom","atomUpd"])])),_:2},1024)))),128))])),_:1}),(0,o.Lk)("div",G,[(0,o.bF)(i,{type:"primary",onClick:a[0]||(a[0]=e=>n())},{default:(0,o.k6)((()=>a[1]||(a[1]=[(0,o.eW)("+ Atom")]))),_:1})])])}}});const Z=Y;var ee=Z,te=a(286),ae=(a(1710),(0,n.Ef)(ee));ae.use(te.Ay$),ae.mount("#app")}},t={};function a(n){var o=t[n];if(void 0!==o)return o.exports;var r=t[n]={exports:{}};return e[n].call(r.exports,r,r.exports,a),r.exports}a.m=e,function(){var e=[];a.O=function(t,n,o,r){if(!n){var l=1/0;for(s=0;s<e.length;s++){n=e[s][0],o=e[s][1],r=e[s][2];for(var u=!0,i=0;i<n.length;i++)(!1&r||l>=r)&&Object.keys(a.O).every((function(e){return a.O[e](n[i])}))?n.splice(i--,1):(u=!1,r<l&&(l=r));if(u){e.splice(s--,1);var c=o();void 0!==c&&(t=c)}}return t}r=r||0;for(var s=e.length;s>0&&e[s-1][2]>r;s--)e[s]=e[s-1];e[s]=[n,o,r]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};a.O.j=function(t){return 0===e[t]};var t=function(t,n){var o,r,l=n[0],u=n[1],i=n[2],c=0;if(l.some((function(t){return 0!==e[t]}))){for(o in u)a.o(u,o)&&(a.m[o]=u[o]);if(i)var s=i(a)}for(t&&t(n);c<l.length;c++)r=l[c],a.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return a.O(s)},n=self["webpackChunkcapsule_frontend"]=self["webpackChunkcapsule_frontend"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=a.O(void 0,[504],(function(){return a(4960)}));n=a.O(n)})();
//# sourceMappingURL=app.a1e41d59.js.map
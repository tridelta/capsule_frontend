(function(){"use strict";var e={1827:function(e,t,a){var n=a(5130),o=(a(4114),a(6768)),l=a(144);const r="http://localhost:5201";var u=r,c=a(4232),i=a(1527),s=a.n(i),d=a(819);const v={class:"quark"},p={key:0,class:"quark-icon"},f={class:"quark-body"},m={class:"quark-content"},k={key:0},g=["src"],y={key:0,class:"quark-transcript"},h=["hidden"],b={class:"popup-bigimg"},w=["src"];function _(e){this.trans_content=e}const q={name:"QuarkViewer"};var C=Object.assign(q,{props:{quarkID:String,displayTrans:Boolean,displayAvatar:Boolean},setup(e){const t={loading:{icon:"refresh",color:"#808080"},text:{icon:"translate",color:"var(--color-primary)"},image:{icon:"image",color:"var(--color-success)"},"transcript/info":{icon:"information",color:"#808080"},"transcript/explain":{icon:"message-text-outline",color:"#808080"}},a=e;var n=(0,l.KR)("");const r=(0,l.KR)(!1),i=(0,l.KR)({id:"Q-1",type:"text",content:"Loading ...",transcripts:[]}),s=(0,l.KR)(t.loading);function q(){const e=`${u}/quark/${a.quarkID}`;fetch(e).then((e=>e.json())).then((e=>{i.value=e.quark,s.value=t[e.quark.type]}))}return q(),(e,q)=>{const C=(0,o.g2)("var-icon"),F=(0,o.g2)("var-avatar"),E=(0,o.g2)("var-divider"),x=(0,o.g2)("var-avatar-group"),L=(0,o.g2)("var-popup");return(0,o.uX)(),(0,o.CE)("div",v,[a.displayAvatar?((0,o.uX)(),(0,o.CE)("div",p,[(0,o.bF)(F,{round:!1,size:"small",color:s.value.color},{default:(0,o.k6)((()=>[(0,o.bF)(C,{name:s.value.icon},null,8,["name"])])),_:1},8,["color"])])):(0,o.Q3)("",!0),(0,o.Lk)("div",f,[(0,o.Lk)("div",m,["text"==i.value.type?((0,o.uX)(),(0,o.CE)("div",k,[(0,o.bF)((0,l.R1)(d.f),{content:i.value.content},null,8,["content"])])):(0,o.Q3)("",!0),"image"==i.value.type?((0,o.uX)(),(0,o.CE)("img",{key:1,onClick:q[0]||(q[0]=e=>r.value=!0),src:`${(0,l.R1)(u)}${i.value.content}`},null,8,g)):(0,o.Q3)("",!0)]),a.displayTrans&&0!=i.value.transcripts.length?((0,o.uX)(),(0,o.CE)("div",y,[(0,o.bF)(E,{dashed:""}),(0,o.bF)(x,null,{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(i.value.transcripts,(e=>((0,o.uX)(),(0,o.Wv)(F,{key:e.id,onClick:t=>_(e.content),hoverable:"",bordered:"",size:"small",color:t[e.type].color},{default:(0,o.k6)((()=>[(0,o.bF)(C,{name:t[e.type].icon},null,8,["name"])])),_:2},1032,["onClick","color"])))),128)),""!=(0,l.R1)(n)?((0,o.uX)(),(0,o.Wv)(F,{key:0,onClick:q[1]||(q[1]=e=>_("")),hoverable:"",size:"small",color:"var(--color-error)"},{default:(0,o.k6)((()=>[(0,o.bF)(C,{name:"window-close",color:"var(--color-danger)"})])),_:1})):(0,o.Q3)("",!0)])),_:1}),(0,o.Lk)("p",{class:"trans-show markdown",hidden:!(0,l.R1)(n)},(0,c.v_)((0,l.R1)(n)),9,h)])):(0,o.Q3)("",!0)]),(0,o.bF)(L,{show:r.value,"onUpdate:show":q[2]||(q[2]=e=>r.value=e)},{default:(0,o.k6)((()=>[(0,o.Lk)("div",b,[(0,o.Lk)("img",{class:"bigimg",src:`${(0,l.R1)(u)}${i.value.content}`},null,8,w)])])),_:1},8,["show"])])}}}),F=a(1241);const E=(0,F.A)(C,[["__scopeId","data-v-759236c8"]]);var x=E,L=a(3080),R=a(8484);const A={key:0,class:"mask"},O={class:"qtype-choose noselect"},j={class:"content-editor"},X={key:0},$={key:1},D={class:"footer-controller"},I={name:"QuarkEditDialog",props:{activate:Boolean,add_quark:Function,closeDialog:Function}};var K=Object.assign(I,{setup(e){const t=(0,l.KR)("text"),a=(0,l.KR)([{label:"Text",value:"text"},{label:"Media",value:"media"}]),n=(0,l.KR)(""),r=(0,l.KR)([]);function c(e){function t(){n.value="",r.value=[],e()}0!=n.value.length||0!=r.value.length?(0,L.Ay)({title:"退出编辑",message:"您有更改尚未保存，推出编辑将丢失更改。确定要退出吗？",confirmButtonText:"退出",cancelButtonText:"继续编辑",onConfirm:t}):t()}function i(e){}async function s(e,t){const a=`${u}/quark`,n=new FormData;n.append("type",e),n.append("content",t);var o=await fetch(a,{method:"POST",body:n});return o.json()}function v(e,t){R.Ay[e](t)}async function p(e,a){var o=[];if("text"===t.value){let a=await s(t.value,n.value);0!=a.code&&v("error","Upload Failed (createQuark."+a.code+")."),o.push(a.quark_id),v("success","Upload Success."),e()}else if("media"===t.value){for(var l=0;l<r.value.length;l++){var u=r.value[l],c=u.file.type.split("/")[0];if("image"!=c&&"video"!=c)return void v("error","Invalid File Type.");let e=await s(c,u.file);if(0!=e.code)return void v("error","Upload Failed (createQuark."+e.code+").");o.push(e.quark_id),u.status="success"}v("success","Upload Success."),e()}a(o)}return(u,s)=>{const v=(0,o.g2)("var-icon"),f=(0,o.g2)("var-button"),m=(0,o.g2)("var-radio-group"),k=(0,o.g2)("var-uploader"),g=(0,o.g2)("var-paper");return e.activate?((0,o.uX)(),(0,o.CE)("div",A,[(0,o.bF)(g,{class:"content"},{default:(0,o.k6)((()=>[(0,o.bF)(f,{type:"danger",round:"","icon-container":"",class:"close-button",onClick:s[0]||(s[0]=t=>c(e.closeDialog))},{default:(0,o.k6)((()=>[(0,o.bF)(v,{name:"window-close"})])),_:1}),s[6]||(s[6]=(0,o.Lk)("h2",{class:"noselect"},"New Quark",-1)),(0,o.Lk)("div",O,[(0,o.bF)(m,{modelValue:t.value,"onUpdate:modelValue":s[1]||(s[1]=e=>t.value=e),options:a.value},null,8,["modelValue","options"])]),(0,o.Lk)("div",j,["text"===t.value?((0,o.uX)(),(0,o.CE)("div",X,[(0,o.bF)((0,l.R1)(d.t),{modelValue:n.value,"onUpdate:modelValue":s[2]||(s[2]=e=>n.value=e)},null,8,["modelValue"])])):(0,o.Q3)("",!0),"media"===t.value?((0,o.uX)(),(0,o.CE)("div",$,[(0,o.bF)(k,{modelValue:r.value,"onUpdate:modelValue":s[3]||(s[3]=e=>r.value=e),multiple:!0,accept:"image/*,video/*",onAfterRead:i},null,8,["modelValue"])])):(0,o.Q3)("",!0)]),(0,o.Lk)("div",D,[(0,o.bF)(f,{type:"success",class:"btn-upload",onClick:s[4]||(s[4]=t=>p(e.closeDialog,e.add_quark))},{default:(0,o.k6)((()=>s[5]||(s[5]=[(0,o.eW)("Save")]))),_:1})])])),_:1})])):(0,o.Q3)("",!0)}}});const Q=(0,F.A)(K,[["__scopeId","data-v-774a8d3e"]]);var T=Q;const U={key:0,class:"atom"},V={class:"atom-head"},S={key:0},M={key:1,class:"edittitle"},W={key:1,class:"add-tag-inputs"},B={class:"atom-info"},N={class:"atom-info"},P={class:"atom-contents"},z={class:"quarks-container"},H={class:"drag-handle"},J={class:"rm-handle"},G={name:"AtomEditView"};Boolean;a(8111),a(7588),a(1701);const Y=["data-aid"],Z={class:"atom-head"},ee={class:"atom-info"},te={class:"atom-info"},ae={name:"AtomCardView"};var ne=Object.assign(ae,{props:{atomID:String,tempAtom:Boolean,atomUpd:Function},setup(e){const t=e,a=(0,l.KR)([]);function n(e){var t=new Date(e),a=new Date,n=a-t;if(n<36e5)return Math.floor(n/6e4)+" minutes ago";if(n<864e5)return Math.floor(n/36e5)+" hours ago";if(n<6048e5){var o=["星期天","星期一","星期二","星期三","星期四","星期五","星期六"];return o[t.getDay()]}return t.toLocaleString()}const r=(0,l.KR)("content-copy");function i(e){r.value="check",navigator.clipboard.writeText(e),setTimeout((()=>{r.value="content-copy"}),1e3)}async function s(e){try{const t=await fetch(`${u}/quark/${e}`),a=await t.json();return a.quark}catch(t){return console.error(`Error fetching quark ${e}:`,t),{type:"text",content:"Error loading quark"}}}async function d(){if(!p.value||!p.value.contents)return;a.value=[];const e=p.value.contents.map((e=>s(e)));try{a.value=await Promise.all(e),f()}catch(t){console.error("Error loading quarks:",t)}}function v(){if(t.tempAtom)return p.value={title:"New Atom",tags:[],id:"A-new",last_modify:"Just Now",contents:[]},void d();var e=`${u}/atom/${t.atomID}`;fetch(e).then((e=>e.json())).then((e=>{p.value=e.atom,d()}))}const p=(0,l.KR)({title:"Loading ..."});function f(){if(!a.value||0===a.value.length)return;const e=k.value;if(!e)return;e.innerHTML="";const t=e.clientWidth;let n=1;t>768?n=3:t>480&&(n=2);const o=[];for(let a=0;a<n;a++){const t=document.createElement("div");t.className="auto-layout-column",t.style.width=100/n+"%",e.appendChild(t),o.push(t)}a.value.forEach(((e,t)=>{const a=t%n,l=m(e);o[a].appendChild(l)}))}function m(e){const t=document.createElement("div");let a;if(t.className="quark-container",t.dataset.qid=e.id,"image"===e.type){a=document.createElement("div"),a.className="quark-image";const t=document.createElement("img");t.classList.add("quark"),t.src=u+e.content,t.alt="Image",t.style.maxWidth="100%",a.appendChild(t)}else"text"===e.type?(a=document.createElement("div"),a.classList.add("quark"),a.className="quark-text",a.textContent=e.content):(a=document.createElement("div"),a.className="quark-unknown",a.classList.add("quark"),a.textContent=`Unknown quark type: ${e.type}`);return t.appendChild(a),t}(0,o.wB)((()=>t.atomID),(()=>{v()})),(0,o.sV)((()=>{v()}));const k=(0,l.KR)(null);return window.addEventListener("resize",(()=>{k.value&&f()})),(e,t)=>{const a=(0,o.g2)("var-badge"),l=(0,o.g2)("var-space"),u=(0,o.g2)("var-icon");return p.value?((0,o.uX)(),(0,o.CE)("div",{key:0,class:"atom","data-aid":p.value.id},[(0,o.Lk)("div",Z,[(0,o.Lk)("h2",null,(0,c.v_)(p.value.title),1),(0,o.bF)(l,null,{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(p.value.tags,(e=>((0,o.uX)(),(0,o.Wv)(a,{key:e,value:e,type:"primary"},null,8,["value"])))),128))])),_:1}),t[1]||(t[1]=(0,o.Lk)("br",null,null,-1)),(0,o.Lk)("li",ee,[(0,o.eW)("ID: "+(0,c.v_)(p.value.id)+" ",1),(0,o.bF)(u,{name:r.value,onClick:t[0]||(t[0]=e=>i(p.value.id))},null,8,["name"])]),(0,o.Lk)("li",te,"Last Modified: "+(0,c.v_)(n(p.value.last_modify)),1)]),(0,o.Lk)("div",{class:"autolayout-container",ref_key:"al_container",ref:k},null,512)],8,Y)):(0,o.Q3)("",!0)}}});const oe=(0,F.A)(ne,[["__scopeId","data-v-3841f703"]]);var le=oe;const re={class:"atom-container"},ue={class:"controllers"},ce={name:"App"};var ie=Object.assign(ce,{setup(e){const t=(0,l.KR)(["?-loading"]);function a(){const e=`${u}/atom_list`;fetch(e).then((e=>e.json())).then((e=>{t.value=e.atom_list}))}function n(){var e=`?-${Math.random()}-${performance.now()}`;t.value.push(e)}function r(e){function a(a){if(console.log("Atom Updated: "+a),"?"==e[0]){var n=t.value.indexOf(e);t.value[n]=a}}return a}return a(),(e,a)=>{const l=(0,o.g2)("var-paper"),u=(0,o.g2)("var-space"),c=(0,o.g2)("var-button");return(0,o.uX)(),(0,o.CE)("div",re,[(0,o.bF)(u,{direction:"column",wrap:"wrap"},{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(t.value,(e=>((0,o.uX)(),(0,o.Wv)(l,{elevation:2,key:e},{default:(0,o.k6)((()=>[(0,o.bF)(le,{atomID:e,tempAtom:"?"==e[0],atomUpd:r(e)},null,8,["atomID","tempAtom","atomUpd"])])),_:2},1024)))),128))])),_:1}),(0,o.Lk)("div",ue,[(0,o.bF)(c,{type:"primary",onClick:a[0]||(a[0]=e=>n())},{default:(0,o.k6)((()=>a[1]||(a[1]=[(0,o.eW)("+ Atom")]))),_:1})])])}}});const se=ie;var de=se,ve=a(286),pe=(a(1710),(0,n.Ef)(de));pe.use(ve.Ay$),pe.mount("#app")}},t={};function a(n){var o=t[n];if(void 0!==o)return o.exports;var l=t[n]={exports:{}};return e[n].call(l.exports,l,l.exports,a),l.exports}a.m=e,function(){var e=[];a.O=function(t,n,o,l){if(!n){var r=1/0;for(s=0;s<e.length;s++){n=e[s][0],o=e[s][1],l=e[s][2];for(var u=!0,c=0;c<n.length;c++)(!1&l||r>=l)&&Object.keys(a.O).every((function(e){return a.O[e](n[c])}))?n.splice(c--,1):(u=!1,l<r&&(r=l));if(u){e.splice(s--,1);var i=o();void 0!==i&&(t=i)}}return t}l=l||0;for(var s=e.length;s>0&&e[s-1][2]>l;s--)e[s]=e[s-1];e[s]=[n,o,l]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var n in t)a.o(t,n)&&!a.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){var e={524:0};a.O.j=function(t){return 0===e[t]};var t=function(t,n){var o,l,r=n[0],u=n[1],c=n[2],i=0;if(r.some((function(t){return 0!==e[t]}))){for(o in u)a.o(u,o)&&(a.m[o]=u[o]);if(c)var s=c(a)}for(t&&t(n);i<r.length;i++)l=r[i],a.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return a.O(s)},n=self["webpackChunkcapsule_frontend"]=self["webpackChunkcapsule_frontend"]||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var n=a.O(void 0,[504],(function(){return a(1827)}));n=a.O(n)})();
//# sourceMappingURL=app.7c170e7e.js.map